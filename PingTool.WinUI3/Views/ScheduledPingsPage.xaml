<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="PingTool.Views.ScheduledPingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="using:PingTool.Converters"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:BoolToBrushConverter x:Key="BoolToBrushConverter" />
    </Page.Resources>


    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Margin="0,0,0,20" Orientation="Horizontal" Spacing="12">
            <Border
                Width="40"
                Height="40"
                Background="{StaticResource AccentGradientBrush}"
                CornerRadius="8">
                <FontIcon
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontFamily="{StaticResource SymbolThemeFontFamily}"
                    FontSize="18"
                    Foreground="White"
                    Glyph="&#xE823;" />
            </Border>
            <StackPanel VerticalAlignment="Center">
                <TextBlock
                    FontSize="24"
                    FontWeight="Bold"
                    Text="Scheduled Pings" />
                <TextBlock
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="Monitor hosts at regular intervals" />
            </StackPanel>
        </StackPanel>

        <!-- Add New Schedule -->
        <Border
            Grid.Row="1"
            Margin="0,0,0,16"
            Padding="16"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            CornerRadius="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MaxWidth="300" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox
                    x:Name="NewHostInput"
                    PlaceholderText="Enter hostname to monitor..."
                    KeyDown="NewHostInput_KeyDown" />
                <ComboBox
                    x:Name="IntervalComboBox"
                    Grid.Column="1"
                    Margin="12,0,0,0"
                    MinWidth="150"
                    SelectedIndex="1">
                    <ComboBoxItem Content="Every 1 minute" Tag="1" />
                    <ComboBoxItem Content="Every 5 minutes" Tag="5" />
                    <ComboBoxItem Content="Every 15 minutes" Tag="15" />
                    <ComboBoxItem Content="Every 30 minutes" Tag="30" />
                    <ComboBoxItem Content="Every hour" Tag="60" />
                </ComboBox>
                <Button
                    Grid.Column="2"
                    Margin="12,0,0,0"
                    Padding="16,8"
                    Click="AddSchedule_Click"
                    Style="{StaticResource AccentButtonStyle}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon
                            FontFamily="{StaticResource SymbolThemeFontFamily}"
                            FontSize="14"
                            Glyph="&#xE710;" />
                        <TextBlock Text="Add" />
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- Scheduled Pings List -->
        <Border
            Grid.Row="2"
            Padding="16"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            CornerRadius="8">
            <Grid>
                <ListView
                    x:Name="SchedulesList"
                    ItemsSource="{x:Bind Schedules}"
                    SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="8,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!-- Status Indicator -->
                                <Ellipse
                                    Width="12"
                                    Height="12"
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    Fill="{Binding IsEnabled, Converter={StaticResource BoolToBrushConverter}}" />

                                <!-- Host Info -->
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="SemiBold"
                                        Text="{Binding Host}" />
                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <TextBlock
                                            FontSize="11"
                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                            Text="{Binding IntervalDisplay}" />
                                        <TextBlock
                                            FontSize="11"
                                            Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                            Text="{Binding StatusDisplay}" />
                                    </StackPanel>
                                </StackPanel>

                                <!-- Run Now Button -->
                                <Button
                                    Grid.Column="2"
                                    Margin="8,0"
                                    Padding="8"
                                    Click="RunNow_Click"
                                    Tag="{Binding Id}"
                                    ToolTipService.ToolTip="Run now">
                                    <FontIcon
                                        FontFamily="{StaticResource SymbolThemeFontFamily}"
                                        FontSize="12"
                                        Glyph="&#xE768;" />
                                </Button>

                                <!-- Toggle Button -->
                                <ToggleSwitch
                                    Grid.Column="3"
                                    Margin="8,0"
                                    IsOn="{Binding IsEnabled, Mode=OneWay}"
                                    OffContent=""
                                    OnContent=""
                                    Toggled="Toggle_Toggled"
                                    Tag="{Binding Id}" />

                                <!-- Delete Button -->
                                <Button
                                    Grid.Column="4"
                                    Padding="8"
                                    Click="Delete_Click"
                                    Tag="{Binding Id}"
                                    ToolTipService.ToolTip="Delete">
                                    <FontIcon
                                        FontFamily="{StaticResource SymbolThemeFontFamily}"
                                        FontSize="12"
                                        Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                                        Glyph="&#xE74D;" />
                                </Button>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <!-- Empty State -->
                <StackPanel
                    x:Name="EmptyState"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="12">
                    <FontIcon
                        HorizontalAlignment="Center"
                        FontFamily="{StaticResource SymbolThemeFontFamily}"
                        FontSize="48"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Glyph="&#xE823;" />
                    <TextBlock
                        HorizontalAlignment="Center"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Text="No scheduled pings yet. Add one above." />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
